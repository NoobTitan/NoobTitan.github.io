<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Ubuntu系统备份与还原</title>
    <link href="/2022/02/23/UbuntuBackup/"/>
    <url>/2022/02/23/UbuntuBackup/</url>
    
    <content type="html"><![CDATA[<h1 id="Ubuntu系统备份与还原"><a href="#Ubuntu系统备份与还原" class="headerlink" title="Ubuntu系统备份与还原"></a>Ubuntu系统备份与还原</h1><h2 id="1-备份"><a href="#1-备份" class="headerlink" title="1.备份"></a>1.备份</h2><ul><li>当前使用的系统</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs routeros">sudo su<br>cd /<br>tar czvpf sys_backup_$(date <span class="hljs-string">&quot;+%Y%m%d-%H%M%S&quot;</span>).tar.gz <span class="hljs-attribute">--exclude</span>=/proc <span class="hljs-attribute">--exclude</span>=/lost+found   <span class="hljs-attribute">--exclude</span>=/mnt <span class="hljs-attribute">--exclude</span>=/sys  <span class="hljs-attribute">--exclude</span>=/media <span class="hljs-attribute">--exclude</span>=/home/vetec/.cache <span class="hljs-attribute">--exclude</span>=/sys_backup_$(date <span class="hljs-string">&quot;+%Y%m%d-%H%M%S&quot;</span>).tar.gz /<br><span class="hljs-comment"># 这一步可能会提示’tar: Error exit delayed from previous errors’，忽略即可</span><br></code></pre></td></tr></table></figure><ul><li>当前路径的系统</li></ul><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">sudo su<br>tar czvpf <span class="hljs-regexp">/sys_backup_$(date &quot;+%Y%m%d-%H%M%S&quot;).tar.gz --exclude=./</span>proc --<span class="hljs-keyword">exclude</span>=.<span class="hljs-regexp">/lost+found   --exclude=./m</span>nt --<span class="hljs-keyword">exclude</span>=.<span class="hljs-regexp">/sys --exclude=./</span>home<span class="hljs-regexp">/fengji/</span>.ros --<span class="hljs-keyword">exclude</span>=.<span class="hljs-regexp">/home/</span>fengji<span class="hljs-regexp">/.config/</span>Code --<span class="hljs-keyword">exclude</span>=.<span class="hljs-regexp">/media --exclude=./</span>home<span class="hljs-regexp">/fengji/</span>.cache --<span class="hljs-keyword">exclude</span>=.<span class="hljs-regexp">/sys_backup_$(date &quot;+%Y%m%d-%H%M%S&quot;).tar.gz ./</span><br></code></pre></td></tr></table></figure><p>以上为系统打包，排除了大部分旧系统中冗余数据。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#打包完成后使用此命令查看精确大小</span><br><span class="hljs-built_in">du</span> -h backup.tar.gz<br></code></pre></td></tr></table></figure><h2 id="2-重装系统"><a href="#2-重装系统" class="headerlink" title="2.重装系统"></a>2.重装系统</h2><p>使用U盘启动盘安装ubuntu16或者ubuntu20系统，安装系统可以分出512MB的efi分区，和&#x2F;根分区。安装完成后进入U盘系统进行系统恢复。</p><h2 id="3-系统恢复"><a href="#3-系统恢复" class="headerlink" title="3.系统恢复"></a>3.系统恢复</h2><p>进入临时系统，把新系统中的grub.cfg和fstab取出保存，再把name.tar.gz复制进入系统盘&#x2F;目录下</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo su<br>sudo cp <span class="hljs-regexp">/media/</span>(Ubuntu)<span class="hljs-regexp">/boot/g</span>rub<span class="hljs-regexp">/grub.cfg ./</span><br>sudo cp <span class="hljs-regexp">/media/</span>(Ubuntu)<span class="hljs-regexp">/etc/</span>fstab ./<br>cp <span class="hljs-regexp">/media/</span>(U盘)<span class="hljs-regexp">/backup.tgz ./</span><br>sudo tar xvpfz backup.tgz -C ./<br>sudo mkdir proc lost+found mnt sys media cdrom<br></code></pre></td></tr></table></figure><p>用新系统中的UUID替换老系统中的grub.cfg和fstab的UUID，其中fstab根据分区情况更改<br>vim替换:<code>%s/老UUID/新UUID/gc</code><br>如果硬件相同，那么已经可以进入新系统了。</p><h2 id="4-实操汇总"><a href="#4-实操汇总" class="headerlink" title="4.实操汇总"></a>4.实操汇总</h2><ol><li>首先备份旧系统ubuntu16为sys_backup_20211214-102530.tar.gz，使用该系统覆盖新电脑新系统，只能使用内核4.15进入系统，此时nouveau禁用，N卡驱动需要重装，有线网卡和无线网卡为最新硬件，没有有效驱动，无法ubuntu16中运行。尝试更换5.10的内核，成功安装内核后重启无法进入系统（无错误黑屏），安装5.11内核出现问题，旧系统依赖版本过低，无法成功安装，而ubuntu16无法升级所需依赖。</li><li>更换新旧电脑的无线网卡，新电脑可以在ubuntu16，内核4.15的条件下，使用旧电脑无线网卡上网，但其有线网卡仍然无法识别，随后再次重装成功升级内核为5.4+，但仍然无法安装有线网卡驱动，该次重装优化了旧系统备份，卸载了N卡驱动，修复了apt问题，同样禁用nouveau，打包为sys_backup_20211215-141023.tar.gz</li><li>最后换回新旧电脑的无线网卡，安装ubuntu20.04.3, 内核版本为5.11，发现有线网卡能正常使用，无线网卡在解决驱动问题后也能正常使用。但在新系统ubuntu20下，原先代码环境不兼容，需要调整。</li><li>修复210无线网卡<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># fix 210 wifi</span><br>sudo mv iwlwifi-ty-a0-gf-a0.pnvm  iwlwifi-ty-a0-gf-a0.pnvm.bak<br>mv <span class="hljs-regexp">/lib/</span>firmware<span class="hljs-regexp">/iwlwifi-ty-a0-gf-a0.pnvm /</span>lib<span class="hljs-regexp">/firmware/i</span>wlwifi-ty-a0-gf-a0.pnvm.bak<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>Ubuntu系统相关</category>
      
    </categories>
    
    
    <tags>
      
      <tag>系统</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>复现HowToCook</title>
    <link href="/2022/02/22/HowToCook/"/>
    <url>/2022/02/22/HowToCook/</url>
    
    <content type="html"><![CDATA[<h1 id="关于HowToCook"><a href="#关于HowToCook" class="headerlink" title="关于HowToCook"></a>关于HowToCook</h1><p><a href="https://github.com/Anduin2017/HowToCook">程序员做饭指南</a></p><p>本人先将复现家常菜系列</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/02/22/hello-world/"/>
    <url>/2022/02/22/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Test Post</title>
    <link href="/2022/02/17/Test-Post/"/>
    <url>/2022/02/17/Test-Post/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
